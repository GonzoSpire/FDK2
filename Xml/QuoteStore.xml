<protocol name="QuoteStore" majorVer="2" minorVer="0">
    <members>
        <message name="LoginRequest" id="0" size="48">
            <fields>
                <field name="Username" offset="8" type="ustring" optional="N" repeatable="N"/>
                <field name="Password" offset="16" type="ustring" optional="N" repeatable="N"/>
                <field name="DeviceId" offset="24" type="string" optional="N" repeatable="N"/>
                <field name="AppId" offset="32" type="string" optional="N" repeatable="N"/>
                <field name="SessionId" offset="40" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="LoginReport" id="1" size="8"/>
        <enum name="LoginRejectReason" size="4">
            <members>
                <member name="IncorrectCredentials" value="0"/>
                <member name="ThrottlingLimits" value="1"/>
                <member name="BlockedLogin" value="2"/>
                <member name="InternalServerError" value="3"/>
                <member name="Other" value="4"/>
            </members>
        </enum>
        <message name="LoginReject" id="2" size="20">
            <fields>
                <field name="Reason" offset="8" type="LoginRejectReason" optional="N" repeatable="N"/>
                <field name="Text" offset="12" type="ustring" optional="Y" repeatable="N"/>
            </fields>
        </message>
        <enum name="LogoutReason" size="4">
            <members>
                <member name="ClientLogout" value="0"/>
                <member name="ServerLogout" value="1"/>
                <member name="DeletedLogin" value="2"/>
                <member name="BlockedLogin" value="3"/>
                <member name="InternalServerError" value="4"/>
                <member name="Other" value="5"/>
            </members>
        </enum>
        <message name="Logout" id="3" size="20">
            <fields>
                <field name="Reason" offset="8" type="LogoutReason" optional="N" repeatable="N"/>
                <field name="Text" offset="12" type="ustring" optional="Y" repeatable="N"/>
            </fields>
        </message>
        <message name="Request" id="4" size="16">
            <subMessages>
                <subMessage name="SymbolListRequest"/>
                <subMessage name="PeriodicityListRequest"/>
                <subMessage name="BarListRequest"/>
                <subMessage name="TickListRequest"/>
                <subMessage name="DownloadRequest"/>
                <subMessage name="DownloadCancelRequest"/>
            </subMessages>
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="Response" id="5" size="16">
            <subMessages>
                <subMessage name="SymbolListReport"/>
                <subMessage name="PeriodicityListReport"/>
                <subMessage name="BarListReport"/>
                <subMessage name="TickListReport"/>
                <subMessage name="DownloadBeginReport"/>
                <subMessage name="DownloadDataReport"/>
                <subMessage name="DownloadEndReport"/>
                <subMessage name="DownloadCancelReport"/>
                <subMessage name="Reject"/>
            </subMessages>
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="SymbolListRequest" id="6" superMessage="Request" size="16">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="SymbolListReport" id="7" superMessage="Response" size="24">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="SymbolIds" offset="16" type="string" optional="N" repeatable="Y"/>
            </fields>
        </message>
        <message name="PeriodicityListRequest" id="8" superMessage="Request" size="24">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="SymbolId" offset="16" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="PeriodicityListReport" id="9" superMessage="Response" size="24">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Periodicities" offset="16" type="string" optional="N" repeatable="Y"/>
            </fields>
        </message>
        <enum name="PriceType" size="4">
            <members>
                <member name="Bid" value="0"/>
                <member name="Ask" value="1"/>
            </members>
        </enum>
        <message name="BarListRequest" id="10" superMessage="Request" size="48">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="SymbolId" offset="16" type="ustring" optional="N" repeatable="N"/>
                <field name="Periodicity" offset="24" type="ustring" optional="N" repeatable="N"/>
                <field name="PriceType" offset="32" type="PriceType" optional="N" repeatable="N"/>
                <field name="From" offset="36" type="timestamp" optional="N" repeatable="N"/>
                <field name="Count" offset="44" type="int32" optional="N" repeatable="N"/>
            </fields>
        </message>
        <group name="Bar" size="48">
            <fields>
                <field name="Time" offset="0" type="timestamp" optional="N" repeatable="N"/>
                <field name="Open" offset="8" type="double" optional="N" repeatable="N"/>
                <field name="High" offset="16" type="double" optional="N" repeatable="N"/>
                <field name="Low" offset="24" type="double" optional="N" repeatable="N"/>
                <field name="Close" offset="32" type="double" optional="N" repeatable="N"/>
                <field name="Volume" offset="40" type="double" optional="N" repeatable="N"/>
            </fields>
        </group>
        <message name="BarListReport" id="11" superMessage="Response" size="24">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Bars" offset="16" type="Bar" optional="N" repeatable="Y"/>
            </fields>
        </message>
        <enum name="TickDepth" size="4">
            <members>
                <member name="Top" value="0"/>
                <member name="Level2" value="1"/>
            </members>
        </enum>
        <message name="TickListRequest" id="12" superMessage="Request" size="40">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="SymbolId" offset="16" type="ustring" optional="N" repeatable="N"/>
                <field name="Depth" offset="24" type="TickDepth" optional="N" repeatable="N"/>
                <field name="From" offset="28" type="timestamp" optional="N" repeatable="N"/>
                <field name="Count" offset="36" type="int32" optional="N" repeatable="N"/>
            </fields>
        </message>
        <group name="PriceLevel" size="16">
            <fields>
                <field name="Price" offset="0" type="double" optional="N" repeatable="N"/>
                <field name="Size" offset="8" type="double" optional="N" repeatable="N"/>
            </fields>
        </group>
        <group name="Tick" size="25">
            <fields>
                <field name="Time" offset="0" type="timestamp" optional="N" repeatable="N"/>
                <field name="Index" offset="8" type="uint8" optional="N" repeatable="N"/>
                <field name="Bids" offset="9" type="PriceLevel" optional="N" repeatable="Y"/>
                <field name="Asks" offset="17" type="PriceLevel" optional="N" repeatable="Y"/>
            </fields>
        </group>
        <message name="TickListReport" id="13" superMessage="Response" size="24">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Ticks" offset="16" type="Tick" optional="N" repeatable="Y"/>
            </fields>
        </message>
        <message name="DownloadRequest" id="14" superMessage="Request" size="32">
            <subMessages>
                <subMessage name="BarDownloadRequest"/>
                <subMessage name="TickDownloadRequest"/>
            </subMessages>
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="From" offset="16" type="timestamp" optional="N" repeatable="N"/>
                <field name="To" offset="24" type="timestamp" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="BarDownloadRequest" id="15" superMessage="DownloadRequest" size="52">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="From" offset="16" type="timestamp" optional="N" repeatable="N"/>
                <field name="To" offset="24" type="timestamp" optional="N" repeatable="N"/>
                <field name="SymbolId" offset="32" type="string" optional="N" repeatable="N"/>
                <field name="PriceType" offset="40" type="PriceType" optional="N" repeatable="N"/>
                <field name="Periodicity" offset="44" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="TickDownloadRequest" id="16" superMessage="DownloadRequest" size="44">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="From" offset="16" type="timestamp" optional="N" repeatable="N"/>
                <field name="To" offset="24" type="timestamp" optional="N" repeatable="N"/>
                <field name="SymbolId" offset="32" type="string" optional="N" repeatable="N"/>
                <field name="Depth" offset="40" type="TickDepth" optional="N" repeatable="N"/>
            </fields>
        </message>
        <group name="FileInfo" size="16">
            <fields>
                <field name="Id" offset="0" type="string" optional="N" repeatable="N"/>
                <field name="Size" offset="8" type="uint64" optional="N" repeatable="N"/>
            </fields>
        </group>
        <message name="DownloadBeginReport" id="17" superMessage="Response" size="40">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Files" offset="16" type="FileInfo" optional="N" repeatable="Y"/>
                <field name="AvailFrom" offset="24" type="timestamp" optional="N" repeatable="N"/>
                <field name="AvailTo" offset="32" type="timestamp" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="DownloadDataReport" id="18" superMessage="Response" size="33">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Id" offset="16" type="string" optional="N" repeatable="N"/>
                <field name="Chunk" offset="24" type="bytes" optional="N" repeatable="N"/>
                <field name="Last" offset="32" type="bool" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="DownloadEndReport" id="19" superMessage="Response" size="16">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="DownloadCancelRequest" id="20" superMessage="Request" size="24">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="RequestId" offset="16" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="DownloadCancelReport" id="21" superMessage="Response" size="16">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <enum name="RejectReason" size="4">
            <members>
                <member name="ThrottlingLimits" value="0"/>
                <member name="RequestCancelled" value="1"/>
                <member name="InternalServerError" value="2"/>
                <member name="Other" value="3"/>
            </members>
        </enum>
        <message name="Reject" id="22" superMessage="Response" size="28">
            <fields>
                <field name="RequestId" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Reason" offset="16" type="RejectReason" optional="N" repeatable="N"/>
                <field name="Text" offset="20" type="ustring" optional="N" repeatable="N"/>
            </fields>
        </message>
        <enum name="NotificationType" size="4">
            <members>
                <member name="ConfigUpdate" value="0"/>
            </members>
        </enum>
        <enum name="NotificationSeverity" size="4">
            <members>
                <member name="Info" value="0"/>
                <member name="Warning" value="1"/>
                <member name="Error" value="2"/>
            </members>
        </enum>
        <message name="Notification" id="23" size="32">
            <fields>
                <field name="Id" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Type" offset="16" type="NotificationType" optional="N" repeatable="N"/>
                <field name="Severity" offset="20" type="NotificationSeverity" optional="N" repeatable="N"/>
                <field name="Text" offset="24" type="string" optional="Y" repeatable="N"/>
            </fields>
        </message>
        <processor name="Client" head="222_13">
            <subProcessors>
                <subProcessor name="ClientRequest"/>
                <subProcessor name="ClientUpdate"/>
            </subProcessors>
            <states>
                <state label="222_13">
                    <operations>
                        <send name="LoginRequest" next="224_17">
                            <messages>
                                <message name="LoginRequest"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="224_17">
                    <operations>
                        <recv name="LoginReport" next="233_13">
                            <messages>
                                <message name="LoginReport"/>
                            </messages>
                        </recv>
                        <recv name="LoginReject" next="222_13">
                            <messages>
                                <message name="LoginReject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="LoginRequest"/>
                    </contexts>
                </state>
                <state label="233_13">
                    <operations>
                        <send next="233_13">
                            <messages>
                                <message name="Request"/>
                            </messages>
                        </send>
                        <recv next="233_13">
                            <messages>
                                <message name="Response"/>
                                <message name="Notification"/>
                            </messages>
                        </recv>
                        <send name="Logout" next="243_17">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                        <recv name="Logout" next="222_13">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="243_17">
                    <operations>
                        <recv next="243_17">
                            <messages>
                                <message name="Response"/>
                                <message name="Notification"/>
                            </messages>
                        </recv>
                        <recv name="Logout" next="222_13">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="Logout"/>
                    </contexts>
                </state>
            </states>
        </processor>
        <processor name="ClientRequest" type="string" superProcessor="Client" head="265_9">
            <fields>
                <field name="Request.Id"/>
                <field name="Response.RequestId"/>
            </fields>
            <states>
                <state label="265_9">
                    <operations>
                        <send name="SymbolListRequest" next="267_13">
                            <messages>
                                <message name="SymbolListRequest"/>
                            </messages>
                        </send>
                        <send name="PeriodicityListRequest" next="274_13">
                            <messages>
                                <message name="PeriodicityListRequest"/>
                            </messages>
                        </send>
                        <send name="BarListRequest" next="281_13">
                            <messages>
                                <message name="BarListRequest"/>
                            </messages>
                        </send>
                        <send name="TickListRequest" next="288_13">
                            <messages>
                                <message name="TickListRequest"/>
                            </messages>
                        </send>
                        <send name="DownloadRequest" next="295_13">
                            <messages>
                                <message name="DownloadRequest"/>
                            </messages>
                        </send>
                        <send name="DownloadCancelRequest" next="310_13">
                            <messages>
                                <message name="DownloadCancelRequest"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="267_13">
                    <operations>
                        <recv name="SymbolListReport">
                            <messages>
                                <message name="SymbolListReport"/>
                            </messages>
                        </recv>
                        <recv name="SymbolListReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="SymbolListRequest"/>
                    </contexts>
                </state>
                <state label="274_13">
                    <operations>
                        <recv name="PeriodicityListReport">
                            <messages>
                                <message name="PeriodicityListReport"/>
                            </messages>
                        </recv>
                        <recv name="PeriodicityListReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="PeriodicityListRequest"/>
                    </contexts>
                </state>
                <state label="281_13">
                    <operations>
                        <recv name="BarListReport">
                            <messages>
                                <message name="BarListReport"/>
                            </messages>
                        </recv>
                        <recv name="BarListReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="BarListRequest"/>
                    </contexts>
                </state>
                <state label="288_13">
                    <operations>
                        <recv name="TickListReport">
                            <messages>
                                <message name="TickListReport"/>
                            </messages>
                        </recv>
                        <recv name="TickListReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="TickListRequest"/>
                    </contexts>
                </state>
                <state label="295_13">
                    <operations>
                        <recv name="DownloadBeginReport" next="297_17">
                            <messages>
                                <message name="DownloadBeginReport"/>
                            </messages>
                        </recv>
                        <recv name="DownloadReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="DownloadRequest"/>
                    </contexts>
                </state>
                <state label="297_17">
                    <operations>
                        <recv name="DownloadDataReport" next="297_17">
                            <messages>
                                <message name="DownloadDataReport"/>
                            </messages>
                        </recv>
                        <recv name="DownloadEndReport">
                            <messages>
                                <message name="DownloadEndReport"/>
                            </messages>
                        </recv>
                        <recv name="DownloadReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="DownloadRequest"/>
                    </contexts>
                </state>
                <state label="310_13">
                    <operations>
                        <recv name="DownloadCancelReport">
                            <messages>
                                <message name="DownloadCancelReport"/>
                            </messages>
                        </recv>
                        <recv name="DownloadCancelReject">
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="DownloadCancelRequest"/>
                    </contexts>
                </state>
            </states>
        </processor>
        <processor name="ClientUpdate" superProcessor="Client" head="324_13">
            <messages>
                <message name="Notification"//>
            </messages>
            <states>
                <state label="324_13">
                    <operations>
                        <recv name="Notification" next="324_13">
                            <messages>
                                <message name="Notification"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
            </states>
        </processor>
        <processor name="Server" head="332_13">
            <subProcessors>
                <subProcessor name="ServerRequest"/>
                <subProcessor name="ServerUpdate"/>
            </subProcessors>
            <states>
                <state label="332_13">
                    <operations>
                        <recv name="LoginRequest" next="334_17">
                            <messages>
                                <message name="LoginRequest"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="334_17">
                    <operations>
                        <send next="343_13">
                            <messages>
                                <message name="LoginReport"/>
                            </messages>
                        </send>
                        <send next="332_13">
                            <messages>
                                <message name="LoginReject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="343_13">
                    <operations>
                        <recv next="343_13">
                            <messages>
                                <message name="Request"/>
                            </messages>
                        </recv>
                        <send next="343_13">
                            <messages>
                                <message name="Response"/>
                                <message name="Notification"/>
                            </messages>
                        </send>
                        <recv name="Logout" next="353_17">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                        <send next="332_13">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="353_17">
                    <operations>
                        <send next="353_17">
                            <messages>
                                <message name="Response"/>
                                <message name="Notification"/>
                            </messages>
                        </send>
                        <send next="332_13">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                    </operations>
                </state>
            </states>
        </processor>
        <processor name="ServerRequest" type="string" superProcessor="Server" head="375_9">
            <fields>
                <field name="Request.Id"/>
                <field name="Response.RequestId"/>
            </fields>
            <states>
                <state label="375_9">
                    <operations>
                        <recv name="SymbolListRequest" next="377_13">
                            <messages>
                                <message name="SymbolListRequest"/>
                            </messages>
                        </recv>
                        <recv name="PeriodicityListRequest" next="384_13">
                            <messages>
                                <message name="PeriodicityListRequest"/>
                            </messages>
                        </recv>
                        <recv name="BarListRequest" next="391_13">
                            <messages>
                                <message name="BarListRequest"/>
                            </messages>
                        </recv>
                        <recv name="TickListRequest" next="398_13">
                            <messages>
                                <message name="TickListRequest"/>
                            </messages>
                        </recv>
                        <recv name="DownloadRequest" next="405_13">
                            <messages>
                                <message name="DownloadRequest"/>
                            </messages>
                        </recv>
                        <recv name="DownloadCancelRequest" next="420_13">
                            <messages>
                                <message name="DownloadCancelRequest"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="377_13">
                    <operations>
                        <send>
                            <messages>
                                <message name="SymbolListReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="384_13">
                    <operations>
                        <send>
                            <messages>
                                <message name="PeriodicityListReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="391_13">
                    <operations>
                        <send>
                            <messages>
                                <message name="BarListReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="398_13">
                    <operations>
                        <send>
                            <messages>
                                <message name="TickListReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="405_13">
                    <operations>
                        <send next="407_17">
                            <messages>
                                <message name="DownloadBeginReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="407_17">
                    <operations>
                        <send next="407_17">
                            <messages>
                                <message name="DownloadDataReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="DownloadEndReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="420_13">
                    <operations>
                        <send>
                            <messages>
                                <message name="DownloadCancelReport"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Reject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
            </states>
        </processor>
        <processor name="ServerUpdate" superProcessor="Server" head="434_13">
            <messages>
                <message name="Notification"//>
            </messages>
            <states>
                <state label="434_13">
                    <operations>
                        <send next="434_13">
                            <messages>
                                <message name="Notification"/>
                            </messages>
                        </send>
                    </operations>
                </state>
            </states>
        </processor>
    </members>
</protocol>
